词法分析

## 记号

- 记号名 --- 用于语法分析
- 属性值 --- 用于词法分析

### 模式

- 描述词法记号的形式

### 词法单元

- 记号的实例

### 词法错误恢复

- 紧急方式
  - 删除错的k个字符，直到遇到正确的记号
- 错误修补
  - 通过删除、插入、替换、交换一个字符得到正确的记号

## 串和语言

- 串是有穷序列
  - 是语言的句子或字
- 语言是串的集合，在词法语法语义上有约束
- 语言运算
  - 并
  - 连接
  - 闭包
  - 正闭包
- 正规式的描述
  - 考虑字符的个数奇数偶数，位置长度
- 状态转换图
- 有限自动机
  - NFA
  - DFA


### 正规式

语言的数学表达式

只能表达语言的词法部分

我们约定正规式r表示的语言为L(r)

- 正规定义
  - 正规式拆分成多个定义
  - 可以用于处理复杂问题
  
- 状态转换图

- 正规式- nfa -dfa - 最简dfa - 分析器

## LL1文法

正规式无法很好的表示语法

需要文法来描述，这叫形式描述

正规式和文法都是形式语言

- 消除左递归
- 消除回溯
- 去掉无用产生式
  - 无用符号
    - 无法被推导
    - 无法终止

短语 - 有关 - 无关 - 正规


### FIRST(E)

S 推导出 E = a....

E ---> E1 E2 E3 ...

FIRST(E) >= FIRST(E1)   

​			   >= FIRST(E2) 前一个式子有空串

​				....

### FOLLOW(E)

S 推导出  Eb....

E ---> ... E1 

E--->...E3E2

S ---> ...EQ1Q2

FOLLOW(S) >= $

FOLLOW(E) >= FIRST(Q1)

​					>= Follow(Q2)

FOLLOW(E1)  >= FOLLOW(E)			

FOLLOW(E1)  >= FOLLOW(E)


核心项目照抄

非核心项目看环境

# 语义翻译


## 辅助函数

1. 属性计算

   - addtype()

2. 抽象语法树

   1. mkLeaf
   2. mkNode

3. 中间代码生成

   - gen() 
     - 生成代码

   - emit()

   - newLabel()
     - 创建 跳转标签

## 属性


综合属性：自下而上，看自身属性就行

继承属性：要看上下文,依赖左边属性的叫L属性

计算分析树结点属性值的过程叫做注释（加注）或修饰。

1. 属性
   1. val
   2. dummy
   3. type
   4. in
   5. id.entry
   6. digit.lexval
2. 中间代码生成
   1. code
   2. true
   3. false
   4. begin
   5. next

## 语法制导定义

## 语法制导翻译



 # 类型检查

拒绝 不被捕获的类型错误，有选择性的拒绝会被捕获的类型错误

生成良行为程序，定义安全语言。

1. 静态类型检查

   - 只能检测一部分类型错误

   - 减轻动态类型工作

   - 拒绝禁止错误

   - 得到良类型程序

2. 动态类型检查

   - 可以检测所有错误

   - 拒绝静态类型无法检测的类型错误

   - 得到良行为程序

## 语言类型
![](Pasted%20image%2020220622122951.png)
- 类型化语言
- 无类型化语言

## 语言类型

### 基本类型

- integer
- real
- boolean
- char
- void
- type_error

### 特殊类型

- array(num, T)
- pointer(T)
- T1×T2×…×Tn→R
- record(N1: T1, N2: T2,…, Nn: Tn))

## 类型系统



# 空间分配

名字 - 环境 - 储存单元 -- 值

局部名字

非局部名字

## 过程

活动树和运行栈

值调用

引用调用

换名调用

# 中间语言

语法制导构造语法树

- 后缀

- 图形
  - 语法树
  - 有向无环图DAG 合并子图

- 三地址
  - 只有一个运算符
  - x = y op z

- 静态单赋值

  - 和三地址类似

  - 但是不能给一个变量赋值多次

    ## 控制流

    gen newlabel || 

    标号：代码

